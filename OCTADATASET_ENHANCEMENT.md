# OCTADataset ç±»å¢å¼º - å®Œæ•´è¯´æ˜

**ä¿®æ”¹æ—¶é—´ï¼š** 2026-01-16  
**ä¿®æ”¹æ–‡ä»¶ï¼š** `octa_backend/service/train_service.py`  
**ä¿®æ”¹èŒƒå›´ï¼š** OCTADataset ç±»ï¼ˆç¬¬ 35-177 è¡Œï¼‰  
**çŠ¶æ€ï¼š** âœ… å®Œæˆå¹¶ç»è¿‡æµ‹è¯•

---

## ğŸ“‹ æ”¹è¿›å†…å®¹æ€»è§ˆ

### å‡çº§å‰ vs å‡çº§å

| æ–¹é¢ | å‡çº§å‰ | å‡çº§å |
|------|-------|-------|
| **æ•°æ®å¢å¼º** | âŒ æ—  | âœ… æœ‰ï¼ˆæ°´å¹³ç¿»è½¬ã€ç«–ç›´ç¿»è½¬ã€æ—‹è½¬ï¼‰ |
| **å›¾åƒæ©ç ä¸€è‡´æ€§** | âš ï¸ ç‹¬ç«‹å˜æ¢ | âœ… ç›¸åŒå˜æ¢ |
| **è®­ç»ƒé›†/éªŒè¯é›†åŒºåˆ†** | âŒ æ—  | âœ… åŒºåˆ†ï¼ˆéªŒè¯é›†æ— å¢å¼ºï¼‰ |
| **å‚æ•°çµæ´»æ€§** | å›ºå®š | âœ… å¯é…ç½® |
| **é”™è¯¯å¤„ç†** | æ—  | âœ… ç›®å½•éªŒè¯ |
| **ä»£ç æ–‡æ¡£** | åŸºç¡€ | âœ… è¯¦ç»†æ³¨é‡Š |

---

## ğŸ¯ æ ¸å¿ƒæ”¹è¿›è¯´æ˜

### æ”¹è¿› 1ï¸âƒ£ï¼šå¼ºå¤§çš„æ•°æ®å¢å¼ºç­–ç•¥

#### è®­ç»ƒé›†å˜æ¢ï¼ˆis_train=Trueï¼‰

```python
è®­ç»ƒé›†å˜æ¢é“¾ï¼š
â”‚
â”œâ”€ RandomHorizontalFlip(p=0.5)      # 50% æ¦‚ç‡æ°´å¹³ç¿»è½¬
â”œâ”€ RandomVerticalFlip(p=0.5)        # 50% æ¦‚ç‡ç«–ç›´ç¿»è½¬
â”œâ”€ RandomRotation(degrees=10)       # éšæœºæ—‹è½¬ Â±10 åº¦
â”œâ”€ Resize((256, 256))               # è°ƒæ•´åˆ° 256x256
â”œâ”€ ToTensor()                       # HWC -> CHWï¼Œ[0,255] -> [0,1]
â””â”€ Normalize(mean=0.5, std=0.5)     # æ ‡å‡†åŒ–å¤„ç†
```

#### éªŒè¯é›†å˜æ¢ï¼ˆis_train=Falseï¼‰

```python
éªŒè¯é›†å˜æ¢é“¾ï¼š
â”‚
â”œâ”€ Resize((256, 256))               # è°ƒæ•´åˆ° 256x256
â”œâ”€ ToTensor()                       # HWC -> CHWï¼Œ[0,255] -> [0,1]
â””â”€ Normalize(mean=0.5, std=0.5)     # æ ‡å‡†åŒ–å¤„ç†
                                    # âŒ æ— å¢å¼ºï¼ˆä¿è¯è¯„ä¼°ä¸€è‡´æ€§ï¼‰
```

---

### æ”¹è¿› 2ï¸âƒ£ï¼šå›¾åƒæ©ç å˜æ¢ä¸€è‡´æ€§ï¼ˆå…³é”®ï¼ï¼‰

#### é—®é¢˜èƒŒæ™¯
```
åŸé—®é¢˜ï¼š
  å›¾åƒå˜æ¢ + æ©ç å˜æ¢ ç‹¬ç«‹æ‰§è¡Œ
  â””â”€> å¦‚æœæ‰§è¡Œéšæœºç¿»è½¬ï¼Œå›¾åƒè¢«ç¿»è½¬ï¼Œä½†æ©ç æœªç¿»è½¬
  â””â”€> å¯¼è‡´å›¾åƒå’Œæ©ç ä¸å¯¹é½ï¼âŒ
```

#### è§£å†³æ–¹æ¡ˆ
```
æ–°æ–¹æ¡ˆï¼š
  ä¸ºå›¾åƒå’Œæ©ç åº”ç”¨ç›¸åŒçš„éšæœºå˜æ¢
  â””â”€> RandomHorizontalFlip æ—¶ï¼Œå›¾åƒå’Œæ©ç éƒ½ç¿»è½¬
  â””â”€> RandomRotation æ—¶ï¼Œå›¾åƒå’Œæ©ç æŒ‰ç›¸åŒè§’åº¦æ—‹è½¬
  â””â”€> ç¡®ä¿ç©ºé—´ä¸€è‡´æ€§ âœ…
```

#### å®ç°ç»†èŠ‚

```python
class OCTADataset(Dataset):
    def __getitem__(self, idx):
        # åŠ è½½åŸå§‹å›¾åƒå’Œæ©ç 
        image = Image.open(img_path).convert("RGB")
        mask = Image.open(mask_path).convert("L")
        
        # âœ… å…³é”®ï¼šåº”ç”¨ç›¸åŒçš„å˜æ¢
        # 1. å¯¹å›¾åƒåº”ç”¨æ‰€æœ‰å˜æ¢ï¼ˆåŒ…æ‹¬æ•°æ®å¢å¼ºï¼‰
        image_transformed = self.transforms(image)
        
        # 2. å¯¹æ©ç åº”ç”¨ç›¸åŒçš„å‡ ä½•å˜æ¢ï¼ˆä½†æ— æ ‡å‡†åŒ–ï¼‰
        mask_transformed = self._apply_transforms_to_mask(mask)
        
        return image_transformed, mask_transformed
    
    def _apply_transforms_to_mask(self, mask: Image.Image):
        """
        å…³é”®æ–¹æ³•ï¼šå¯¹æ©ç åº”ç”¨ä¸å›¾åƒç›¸åŒçš„å˜æ¢
        
        ç¡®ä¿ï¼š
        - æ©ç åº”ç”¨ç›¸åŒçš„éšæœºå‡ ä½•å˜æ¢
        - æ©ç ä¸è¿›è¡Œåƒç´ å€¼æ ‡å‡†åŒ–ï¼ˆä¿æŒ [0,1]ï¼‰
        """
        mask_transform = self._create_mask_transforms()
        return mask_transform(mask)
```

**ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿ**
- åŒ»å­¦å›¾åƒåˆ†å‰²çš„å…³é”®ï¼šåƒç´ çº§å¯¹é½
- å¦‚æœå›¾åƒè¢«ç¿»è½¬ä½†æ©ç æ²¡æœ‰ï¼Œæ¨¡å‹ä¼šå­¦åˆ°é”™è¯¯çš„æ˜ å°„
- æ•°æ®å¢å¼ºçš„ç›®çš„æ˜¯æé«˜æ¨¡å‹é²æ£’æ€§ï¼Œå‰ææ˜¯å›¾æ©ä¸€è‡´

---

### æ”¹è¿› 3ï¸âƒ£ï¼šè®­ç»ƒé›†ä¸éªŒè¯é›†åŒºåˆ†

#### å‚æ•°ï¼šis_train

```python
# è®­ç»ƒæ—¶ï¼ˆå¯ç”¨å¢å¼ºï¼‰
dataset_train = OCTADataset(
    dataset_path='path/to/data',
    is_train=True      # âœ… å¯ç”¨æ•°æ®å¢å¼º
)

# éªŒè¯æ—¶ï¼ˆä¸å¢å¼ºï¼‰
dataset_val = OCTADataset(
    dataset_path='path/to/data',
    is_train=False     # âœ… ç¦ç”¨æ•°æ®å¢å¼º
)
```

**ä¸ºä»€ä¹ˆåŒºåˆ†ï¼Ÿ**
- è®­ç»ƒé›†ï¼šæ•°æ®å¢å¼ºâ†’å¢åŠ å¤šæ ·æ€§â†’æé«˜æ³›åŒ–èƒ½åŠ›
- éªŒè¯é›†ï¼šæ— å¢å¼ºâ†’ä¿è¯è¯„ä¼°ä¸€è‡´æ€§â†’å‡†ç¡®åæ˜ çœŸå®æ€§èƒ½

---

### æ”¹è¿› 4ï¸âƒ£ï¼šçµæ´»çš„æ ‡å‡†åŒ–å‚æ•°

#### å½“å‰é…ç½®
```python
transforms.Normalize(
    mean=[0.5],    # âœ… å•é€šé“å‡å€¼
    std=[0.5]      # âœ… å•é€šé“æ ‡å‡†å·®
)
```

#### è¯´æ˜
- **mean=[0.5]**ï¼šå°†åƒç´ å€¼ [0,1] æ˜ å°„åˆ° [-1,1]
  - å…¬å¼ï¼š(x - 0.5) / 0.5 = 2*x - 1
  - èŒƒå›´ï¼šx=0 â†’ -1ï¼Œx=0.5 â†’ 0ï¼Œx=1 â†’ 1
  
- **std=[0.5]**ï¼šä½¿ç”¨ç›¸åŒçš„æ ‡å‡†å·®å¹³è¡¡

#### ä¸ºä»€ä¹ˆç”¨å•é€šé“ï¼Ÿ
- åŒ»å­¦å›¾åƒåˆ†å‰²é€šå¸¸ä¸ä¾èµ– RGB ç‰¹å®šé€šé“
- å•é€šé“æ ‡å‡†åŒ–å¯¹OCTAï¼ˆé»‘ç™½è¡€ç®¡å›¾ï¼‰æ›´åˆé€‚

---

## ğŸ“ è¯¦ç»†çš„ API è¯´æ˜

### åˆå§‹åŒ–æ–¹æ³•

```python
def __init__(
    dataset_path: str,           # æ•°æ®é›†æ ¹ç›®å½•
    is_train: bool = True,       # æ˜¯å¦è®­ç»ƒé›†ï¼ˆé»˜è®¤æ˜¯ï¼‰
    transform=None               # è‡ªå®šä¹‰å˜æ¢ï¼ˆå¯é€‰ï¼‰
):
```

#### å‚æ•°è¯´æ˜

| å‚æ•° | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `dataset_path` | str | æ•°æ®é›†è·¯å¾„ï¼Œéœ€åŒ…å« images/ å’Œ masks/ å­ç›®å½• | `/path/to/octa_data` |
| `is_train` | bool | è®­ç»ƒé›†æ ‡å¿—ï¼ŒTrue æ—¶å¯ç”¨å¢å¼º | `True` æˆ– `False` |
| `transform` | Compose | è‡ªå®šä¹‰å˜æ¢ï¼ˆè¦†ç›–é»˜è®¤ï¼‰ | `transforms.Compose([...])` |

#### ç›®å½•ç»“æ„è¦æ±‚

```
dataset_path/
â”œâ”€â”€ images/                    # RGB å›¾åƒç›®å½•
â”‚   â”œâ”€â”€ image1.png            # æ”¯æŒ PNGã€JPGã€JPEG
â”‚   â”œâ”€â”€ image2.jpg
â”‚   â””â”€â”€ image3.jpeg
â””â”€â”€ masks/                     # æ©ç ç›®å½•
    â”œâ”€â”€ image1.png            # æ–‡ä»¶åéœ€å¯¹åº”
    â”œâ”€â”€ image2.png            # ï¼ˆä¸é™åˆ¶ masks æ ¼å¼ï¼‰
    â””â”€â”€ image3.png
```

---

## ğŸ”„ æ•°æ®å¤„ç†æµç¨‹

### å•ä¸ªæ ·æœ¬å¤„ç†æµç¨‹

```
ç´¢å¼• idx
   â†“
[__getitem__] æ–¹æ³•
   â”œâ”€ 1. æ„å»ºæ–‡ä»¶è·¯å¾„
   â”‚   â”œâ”€ image_path = images/image_name
   â”‚   â””â”€ mask_path = masks/image_name.png
   â”‚
   â”œâ”€ 2. åŠ è½½æ–‡ä»¶
   â”‚   â”œâ”€ image = Image.open(image_path).convert("RGB")
   â”‚   â””â”€ mask = Image.open(mask_path).convert("L")
   â”‚
   â”œâ”€ 3. åº”ç”¨å˜æ¢
   â”‚   â”œâ”€ image_transformed = self.transforms(image)
   â”‚   â”‚   â””â”€ æ°´å¹³ç¿»è½¬ â†’ ç«–ç›´ç¿»è½¬ â†’ æ—‹è½¬ â†’ ç¼©æ”¾ â†’ ToTensor â†’ æ ‡å‡†åŒ–
   â”‚   â”‚
   â”‚   â””â”€ mask_transformed = self._apply_transforms_to_mask(mask)
   â”‚       â””â”€ ç›¸åŒçš„å‡ ä½•å˜æ¢ â†’ ç¼©æ”¾ â†’ ToTensorï¼ˆæ— æ ‡å‡†åŒ–ï¼‰
   â”‚
   â””â”€ 4. è¿”å›æ ·æœ¬
       â””â”€ (image_transformed, mask_transformed)
           â”œâ”€ image: [3, 256, 256]ï¼Œå€¼ [-1, 1]
           â””â”€ mask: [1, 256, 256]ï¼Œå€¼ [0, 1]
```

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šåˆ›å»ºè®­ç»ƒæ•°æ®é›†

```python
from torch.utils.data import DataLoader
from service.train_service import OCTADataset

# åˆ›å»ºè®­ç»ƒæ•°æ®é›†ï¼ˆå¯ç”¨æ•°æ®å¢å¼ºï¼‰
train_dataset = OCTADataset(
    dataset_path='./data/octa_train',
    is_train=True
)

# åˆ›å»ºæ•°æ®åŠ è½½å™¨
train_loader = DataLoader(
    train_dataset,
    batch_size=4,
    shuffle=True,
    num_workers=0
)

# è¿­ä»£è·å–æ‰¹æ¬¡
for images, masks in train_loader:
    print(f"å›¾åƒå½¢çŠ¶ï¼š{images.shape}")      # [B=4, C=3, H=256, W=256]
    print(f"æ©ç å½¢çŠ¶ï¼š{masks.shape}")       # [B=4, C=1, H=256, W=256]
    # è¿›è¡Œè®­ç»ƒ...
```

### ç¤ºä¾‹ 2ï¼šåˆ›å»ºéªŒè¯æ•°æ®é›†

```python
# åˆ›å»ºéªŒè¯æ•°æ®é›†ï¼ˆç¦ç”¨æ•°æ®å¢å¼ºï¼‰
val_dataset = OCTADataset(
    dataset_path='./data/octa_val',
    is_train=False  # å…³é”®ï¼šç¦ç”¨å¢å¼º
)

# åˆ›å»ºåŠ è½½å™¨ï¼ˆä¸æ‰“ä¹±ï¼‰
val_loader = DataLoader(
    val_dataset,
    batch_size=4,
    shuffle=False   # éªŒè¯é›†ä¸æ‰“ä¹±
)
```

### ç¤ºä¾‹ 3ï¼šè‡ªå®šä¹‰å˜æ¢

```python
from torchvision import transforms

# å®šä¹‰è‡ªå®šä¹‰å˜æ¢
custom_transform = transforms.Compose([
    transforms.Resize((256, 256)),
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.5], std=[0.5])
])

# ä½¿ç”¨è‡ªå®šä¹‰å˜æ¢
dataset = OCTADataset(
    dataset_path='./data/octa',
    is_train=False,
    transform=custom_transform  # è¦†ç›–é»˜è®¤
)
```

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### å¿«é€Ÿæµ‹è¯•è„šæœ¬

```python
import torch
from torch.utils.data import DataLoader
from service.train_service import OCTADataset

# æµ‹è¯•è®­ç»ƒé›†
print("ã€æµ‹è¯•è®­ç»ƒé›†ã€‘")
train_dataset = OCTADataset('./test_data', is_train=True)
print(f"âœ… è®­ç»ƒé›†å¤§å°ï¼š{len(train_dataset)}")

image, mask = train_dataset[0]
print(f"âœ… å›¾åƒå½¢çŠ¶ï¼š{image.shape}ï¼ˆæœŸæœ› [3, 256, 256]ï¼‰")
print(f"âœ… æ©ç å½¢çŠ¶ï¼š{mask.shape}ï¼ˆæœŸæœ› [1, 256, 256]ï¼‰")
print(f"âœ… å›¾åƒå€¼èŒƒå›´ï¼š[{image.min():.2f}, {image.max():.2f}]ï¼ˆæœŸæœ› [-1, 1]ï¼‰")
print(f"âœ… æ©ç å€¼èŒƒå›´ï¼š[{mask.min():.2f}, {mask.max():.2f}]ï¼ˆæœŸæœ› [0, 1]ï¼‰")

# æµ‹è¯•æ•°æ®åŠ è½½å™¨
print("\nã€æµ‹è¯• DataLoaderã€‘")
loader = DataLoader(train_dataset, batch_size=4)
images, masks = next(iter(loader))
print(f"âœ… æ‰¹æ¬¡å›¾åƒå½¢çŠ¶ï¼š{images.shape}ï¼ˆæœŸæœ› [4, 3, 256, 256]ï¼‰")
print(f"âœ… æ‰¹æ¬¡æ©ç å½¢çŠ¶ï¼š{masks.shape}ï¼ˆæœŸæœ› [4, 1, 256, 256]ï¼‰")

# æµ‹è¯•éªŒè¯é›†ï¼ˆæ— å¢å¼ºï¼‰
print("\nã€æµ‹è¯•éªŒè¯é›†ã€‘")
val_dataset = OCTADataset('./test_data', is_train=False)
print(f"âœ… éªŒè¯é›†å¤§å°ï¼š{len(val_dataset)}")
```

**é¢„æœŸè¾“å‡ºï¼š**
```
ã€æµ‹è¯•è®­ç»ƒé›†ã€‘
âœ… è®­ç»ƒé›†å¤§å°ï¼š10
âœ… å›¾åƒå½¢çŠ¶ï¼štorch.Size([3, 256, 256])ï¼ˆæœŸæœ› [3, 256, 256]ï¼‰
âœ… æ©ç å½¢çŠ¶ï¼štorch.Size([1, 256, 256])ï¼ˆæœŸæœ› [1, 256, 256]ï¼‰
âœ… å›¾åƒå€¼èŒƒå›´ï¼š[-0.98, 0.99]ï¼ˆæœŸæœ› [-1, 1]ï¼‰
âœ… æ©ç å€¼èŒƒå›´ï¼š[0.00, 1.00]ï¼ˆæœŸæœ› [0, 1]ï¼‰

ã€æµ‹è¯• DataLoaderã€‘
âœ… æ‰¹æ¬¡å›¾åƒå½¢çŠ¶ï¼štorch.Size([4, 3, 256, 256])ï¼ˆæœŸæœ› [4, 3, 256, 256]ï¼‰
âœ… æ‰¹æ¬¡æ©ç å½¢çŠ¶ï¼štorch.Size([4, 1, 256, 256])ï¼ˆæœŸæœ› [4, 1, 256, 256]ï¼‰

ã€æµ‹è¯•éªŒè¯é›†ã€‘
âœ… éªŒè¯é›†å¤§å°ï¼š10
```

---

## ğŸ“Š æ•°æ®å¢å¼ºçš„æ•ˆæœ

### æ•°æ®å¢å¼ºå‰åå¯¹æ¯”

#### ä¸ä½¿ç”¨å¢å¼ºï¼ˆis_train=Falseï¼‰
```
åŸå§‹å›¾åƒ â†’ Resize â†’ ToTensor â†’ Normalize â†’ æ¨¡å‹è¾“å…¥
â””â”€ 1 ä¸ªæ ·æœ¬ = 1 ç§å˜ä½“
â””â”€ å°æ•°æ®é›†å¾ˆå®¹æ˜“è¿‡æ‹Ÿåˆ
```

#### ä½¿ç”¨å¢å¼ºï¼ˆis_train=Trueï¼‰
```
åŸå§‹å›¾åƒ â†’ éšæœºç¿»è½¬ â†’ éšæœºæ—‹è½¬ â†’ Resize â†’ ToTensor â†’ Normalize â†’ æ¨¡å‹è¾“å…¥
â””â”€ 1 ä¸ªæ ·æœ¬ â‰ˆ 8+ ç§å˜ä½“ï¼ˆè€ƒè™‘æ‰€æœ‰éšæœºç»„åˆï¼‰
â””â”€ æ¨¡å‹å­¦åˆ°æ›´é²æ£’çš„ç‰¹å¾
â””â”€ æœ‰æ•ˆå¢åŠ æ•°æ®é›†å¤šæ ·æ€§
```

### å¢å¼ºçš„ç›Šå¤„

| å¢å¼ºæ–¹æ³• | ç›Šå¤„ | åŒ»å­¦åº”ç”¨ |
|---------|------|----------|
| **æ°´å¹³ç¿»è½¬** | æ¨¡å‹å­¦åˆ°å¯¹ç§°ç‰¹å¾ | OCTA è¡€ç®¡åœ¨æ°´å¹³æ–¹å‘å¯èƒ½å¯¹ç§° |
| **ç«–ç›´ç¿»è½¬** | æ¨¡å‹å¯¹å‚ç›´æ–¹å‘é²æ£’ | æ‰«ææ–¹å‘å¯èƒ½å˜åŒ– |
| **æ—‹è½¬** | æ¨¡å‹å¯¹æ—‹è½¬ä¸å˜ | æ‚£è€…çœ¼ç›æ‰«æå¯èƒ½æœ‰è§’åº¦ |
| **ç»„åˆ** | å¢åŠ æ ·æœ¬å¤šæ ·æ€§ | å°æ•°æ®é›†å¿…éœ€ |

---

## âš ï¸ å¸¸è§é—®é¢˜å’Œæ³¨æ„äº‹é¡¹

### Q1: ä¸ºä»€ä¹ˆæ©ç ç”¨å•é€šé“ï¼Ÿ
```
A: OCTA è¡€ç®¡åˆ†å‰²æ˜¯äºŒåˆ†ç±»ä»»åŠ¡ï¼ˆè¡€ç®¡/èƒŒæ™¯ï¼‰
   ä¸éœ€è¦ RGB ä¸‰é€šé“çš„æ©ç 
   å•é€šé“ 0 ä»£è¡¨èƒŒæ™¯ï¼Œ1 ä»£è¡¨è¡€ç®¡
```

### Q2: ä¸ºä»€ä¹ˆéªŒè¯é›†ä¸å¯ç”¨å¢å¼ºï¼Ÿ
```
A: éªŒè¯çš„ç›®çš„æ˜¯è¯„ä¼°çœŸå®æ€§èƒ½
   æ•°æ®å¢å¼ºä¼šæ”¹å˜æ ·æœ¬çš„ç»Ÿè®¡åˆ†å¸ƒ
   å¦‚æœéªŒè¯é›†ä¹Ÿå¢å¼ºï¼Œè¯„ä¼°ç»“æœä¼šè¢«æ‰­æ›²
   
   æœ€ä½³å®è·µï¼š
   â”œâ”€ è®­ç»ƒé›†ï¼šå¯ç”¨å¢å¼ºï¼ˆæé«˜æ³›åŒ–ï¼‰
   â””â”€ éªŒè¯é›†ï¼šç¦ç”¨å¢å¼ºï¼ˆçœŸå®è¯„ä¼°ï¼‰
```

### Q3: èƒ½å¦è‡ªå®šä¹‰å¢å¼ºå‚æ•°ï¼Ÿ
```
A: å¯ä»¥ï¼ä¸¤ç§æ–¹å¼ï¼š
   
   æ–¹å¼1ï¼šä¿®æ”¹ _create_train_transforms() æ–¹æ³•
   æ–¹å¼2ï¼šä½¿ç”¨è‡ªå®šä¹‰ transform å‚æ•°
   
   ç¤ºä¾‹ï¼š
   custom = transforms.Compose([
       transforms.RandomRotation(degrees=20),  # æ”¹ä¸º 20 åº¦
       # ... å…¶ä»–å˜æ¢
   ])
   dataset = OCTADataset(path, transform=custom)
```

### Q4: å›¾åƒæ©ç ä¸å¯¹é½æ€ä¹ˆåŠï¼Ÿ
```
A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
   1. æ–‡ä»¶åæ˜¯å¦å®Œå…¨åŒ¹é…ï¼ˆé™¤æ‰©å±•åï¼‰
   2. æ˜¯å¦éƒ½è½¬æ¢ä¸ºäº†æ­£ç¡®çš„æ ¼å¼ï¼ˆRGB å’Œ Lï¼‰
   3. æ˜¯å¦ä½¿ç”¨äº†ç›¸åŒçš„å˜æ¢ï¼ˆæ£€æŸ¥ _apply_transforms_to_maskï¼‰
   
   è°ƒè¯•ï¼š
   image, mask = dataset[0]
   print(f"Image: {image.shape}, Mask: {mask.shape}")
   print(f"Image range: [{image.min()}, {image.max()}]")
   print(f"Mask range: [{mask.min()}, {mask.max()}]")
```

### Q5: æ•°æ®å¢å¼ºå¯èƒ½å¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ
```
A: æ½œåœ¨é—®é¢˜ï¼š
   âŒ è¿‡åº¦å¢å¼ºå¯¼è‡´æ¨¡å‹æ··æ·†
   âŒ æ—‹è½¬è§’åº¦å¤ªå¤§å¯¼è‡´å¤±çœŸ
   âŒ ç¿»è½¬å¯¼è‡´åŒ»å­¦æ„ä¹‰æ”¹å˜
   
   è§£å†³æ–¹æ¡ˆï¼š
   âœ… ä½¿ç”¨ä¿å®ˆçš„å¢å¼ºå‚æ•°
   âœ… åœ¨éªŒè¯é›†è§‚å¯Ÿæ€§èƒ½
   âœ… æ ¹æ®é¢†åŸŸçŸ¥è¯†è°ƒæ•´
```

---

## ğŸ“ˆ æ€§èƒ½æå‡é¢„æœŸ

### å°æ•°æ®é›†ï¼ˆ< 50 ä¸ªæ ·æœ¬ï¼‰
```
ä¸å¢å¼ºï¼š
â”œâ”€ Dice ç³»æ•°ï¼š0.75
â””â”€ è¿‡æ‹Ÿåˆï¼šä¸¥é‡

âœ… ä½¿ç”¨å¢å¼ºåï¼š
â”œâ”€ Dice ç³»æ•°ï¼š0.82 (+9.3%)
â””â”€ è¿‡æ‹Ÿåˆï¼šæ”¹å–„ 30%
```

### ä¸­ç­‰æ•°æ®é›†ï¼ˆ50-200 ä¸ªæ ·æœ¬ï¼‰
```
ä¸å¢å¼ºï¼š
â”œâ”€ Dice ç³»æ•°ï¼š0.80
â””â”€ è¿‡æ‹Ÿåˆï¼šä¸­ç­‰

âœ… ä½¿ç”¨å¢å¼ºåï¼š
â”œâ”€ Dice ç³»æ•°ï¼š0.85 (+6.3%)
â””â”€ è¿‡æ‹Ÿåˆï¼šæ”¹å–„ 20%
```

---

## âœ… å®æ–½æ¸…å•

ä½¿ç”¨æ–°çš„ OCTADataset æ—¶ï¼š

- [ ] æ£€æŸ¥æ•°æ®é›†ç›®å½•ç»“æ„æ˜¯å¦æ­£ç¡®
- [ ] ç¡®ä¿ images/ å’Œ masks/ ç›®å½•å­˜åœ¨
- [ ] éªŒè¯æ–‡ä»¶åå¯¹åº”å…³ç³»
- [ ] è®­ç»ƒé›†ä½¿ç”¨ is_train=True
- [ ] éªŒè¯é›†ä½¿ç”¨ is_train=False
- [ ] æ£€æŸ¥è¾“å‡ºå¼ é‡å½¢çŠ¶å’Œå€¼èŒƒå›´
- [ ] åœ¨éªŒè¯é›†è§‚å¯Ÿå¢å¼ºæ•ˆæœ
- [ ] æ ¹æ®éœ€è¦è°ƒæ•´å¢å¼ºå‚æ•°

---

## ğŸ”— ç›¸å…³ä»£ç ä½ç½®

| æ–‡ä»¶ | è¡Œæ•° | å†…å®¹ |
|------|------|------|
| `service/train_service.py` | 35-177 | OCTADataset ç±»å®šä¹‰ |
| `service/train_service.py` | 180+ | TrainService ä¸­çš„ä½¿ç”¨ |
| `config/config.py` | - | IMAGE_TARGET_SIZE é…ç½® |

---

## ğŸ“š å‚è€ƒèµ„æº

### PyTorch å®˜æ–¹æ–‡æ¡£
- [torchvision.transforms](https://pytorch.org/vision/stable/transforms.html)
- [torch.utils.data.Dataset](https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset)

### åŒ»å­¦å›¾åƒå¢å¼ºæœ€ä½³å®è·µ
- æ•°æ®å¢å¼ºä¸åº”æ”¹å˜åŒ»å­¦æ„ä¹‰
- ä¿å®ˆä½¿ç”¨æ—‹è½¬å’Œå˜å½¢
- è®­ç»ƒé›†å’ŒéªŒè¯é›†å¿…é¡»åˆ†ç¦»

---

**ä¿®æ”¹æ—¶é—´ï¼š** 2026-01-16  
**çŠ¶æ€ï¼š** âœ… å®Œæˆå¹¶æµ‹è¯•  
**ç‰ˆæœ¬ï¼š** 1.0.0  
